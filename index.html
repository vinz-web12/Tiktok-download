<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>TikTok Downloader HD</title>
  <style>
    body {
      background: black;
      color: white;
      font-family: 'Poppins', sans-serif;
      text-align: center;
      margin: 0;
      padding: 20px;
    }

    h1 {
      color: cyan;
      font-size: 24px;
      margin-bottom: 15px;
      text-shadow: 0 0 8px cyan;
    }

    input {
      width: 90%;
      max-width: 500px;
      padding: 10px;
      border-radius: 10px;
      border: none;
      outline: none;
      font-size: 16px;
      margin-bottom: 15px;
    }

    button {
      padding: 10px 20px;
      background-color: cyan;
      color: black;
      border: none;
      border-radius: 8px;
      font-weight: bold;
      cursor: pointer;
      transition: 0.2s;
    }

    button:hover {
      background-color: #00ffff;
      transform: scale(1.05);
    }

    .slide {
      background: #111;
      padding: 10px;
      border-radius: 12px;
      margin: 15px auto;
      box-shadow: 0 0 12px rgba(0, 255, 255, 0.3);
      width: 95%;
      max-width: 600px;
    }

    img {
      width: 100%;
      max-height: 500px;
      object-fit: contain;
      border-radius: 10px;
      margin-bottom: 10px;
    }

    video {
      width: 95%;
      max-width: 600px;
      border-radius: 10px;
      margin: 15px auto;
      display: block;
    }

    .download-btn {
      display: block;
      margin: 10px auto;
      padding: 10px 20px;
      background-color: #00e5ff;
      color: black;
      text-align: center;
      border-radius: 8px;
      font-weight: bold;
      transition: 0.2s;
      width: fit-content;
    }

    .download-btn:hover {
      background-color: #00ffff;
      transform: scale(1.05);
    }

    #result p {
      color: #ccc;
    }
  </style>
</head>
<body>
  <h1>üéµ TikTok Downloader HD</h1>
  <input id="urlInput" type="text" placeholder="Tempel link TikTok di sini..." />
  <br />
  <button onclick="getData()">Preview & Download</button>
  <div id="result"></div>

  <script>
    async function getData() {
      const url = document.getElementById("urlInput").value.trim();
      const result = document.getElementById("result");
      result.innerHTML = "<p>‚è≥ Sedang mengambil data...</p>";

      try {
        const res = await fetch(`https://api.tiklydown.me/api/download?url=${encodeURIComponent(url)}`);
        const data = await res.json();
        const item = data.data;

        result.innerHTML = "";

        // Kalau video
        if (item.play) {
          const audioBtn = document.createElement("a");
          audioBtn.href = item.music;
          audioBtn.download = "sound.mp3";
          audioBtn.className = "download-btn";
          audioBtn.textContent = "‚¨áÔ∏è Download Sound (MP3)";
          result.appendChild(audioBtn);

          const video = document.createElement("video");
          video.src = item.play;
          video.controls = true;
          video.autoplay = false;
          result.appendChild(video);

          const vidBtn = document.createElement("a");
          vidBtn.href = item.play;
          vidBtn.download = `tiktok_${Math.random().toString(36).slice(2, 8)}.mp4`;
          vidBtn.className = "download-btn";
          vidBtn.textContent = "‚¨áÔ∏è Download Video";
          result.appendChild(vidBtn);
        }

        // Kalau foto (image slideshow)
        if (item.images && item.images.length > 0) {
          const audioBtn = document.createElement("a");
          audioBtn.href = item.music;
          audioBtn.download = "sound.mp3";
          audioBtn.className = "download-btn";
          audioBtn.textContent = "‚¨áÔ∏è Download Sound (MP3)";
          result.appendChild(audioBtn);

          await Promise.all(item.images.map(async (imgUrl, i) => {
            const div = document.createElement("div");
            div.className = "slide";

            const img = document.createElement("img");
            img.src = imgUrl;
            img.loading = "lazy";
            img.alt = `Slide ${i + 1}`;
            img.onerror = () => (img.style.display = "none");
            div.appendChild(img);

            const btn = document.createElement("a");
            btn.href = imgUrl;
            btn.download = `slide_${i + 1}_${Math.random().toString(36).slice(2, 7)}.jpg`;
            btn.className = "download-btn";
            btn.textContent = `‚¨áÔ∏è Download Slide ${i + 1}`;
            div.appendChild(btn);

            result.appendChild(div);
          }));
        }

        if (!item.play && (!item.images || item.images.length === 0)) {
          result.innerHTML = "<p>‚ö†Ô∏è Tidak ditemukan konten dari link tersebut.</p>";
        }

      } catch (err) {
        console.error(err);
        result.innerHTML = "<p>‚ùå Terjadi kesalahan. Coba lagi nanti.</p>";
      }
    }
  </script>
</body>
</html>
